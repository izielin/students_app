{% load crispy_forms_tags %}

 <div class="modal-header">
    <h5 class="modal-title"> Set mark</h5>
    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
<form method="post" enctype="multipart/form-data" id="markForm" data-student-url="{% url 'ajax_load_students' %}" novalidate>
  {% csrf_token %}



  <div class="modal-body">
    <table>
         <div class="form-group">
                <input type="hidden" name="course" value="{{ course.id }}" required id="id_course">
         </div>
         <div class="form-group">
                {{ form.student.label_tag }}<br/>
                {{ form.student }}
            </div>
         <div class="form-group">
             <label for="id_mark">Number of points (0-{{ max_mark }}):</label><br>
                <input type="number" name="mark"  required  min="1" max="{{max_mark}}" id="id_mark">
            </div>
    </table>
  </div>

  <div class="modal-footer">
    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
    <button type="submit" class="submit-btn btn btn-primary">Create</button>
  </div>
</form>

<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
<script>
    $(document).ready(function() {
    console.log('sanity check');
var input = document.getElementById("id_course");

  var url = $("#markForm").attr("data-student-url");
  var courseId = input.value;
  console.log(courseId);

  $.ajax({
    url: url,
    data: {
      'course': courseId
    },
    success: function (data) {
        console.log(data);
      $("#id_student").html(data);
    }
  });
});
</script>